# Настройка SSH доступа

## Информация о сервере

- **Адрес**: 43.245.224.114
- **Пользователь**: root
- **SSH ключ**: ~/.ssh/id_ed25519

## Что было настроено

1. **Создан SSH ключ ED25519**
   - Приватный ключ: `~/.ssh/id_ed25519`
   - Публичный ключ: `~/.ssh/id_ed25519.pub`
   - Без парольной защиты для удобства автоматизации

2. **Публичный ключ скопирован на сервер**
   - Добавлен в `~/.ssh/authorized_keys` на удаленном сервере
   - Теперь можно подключаться без ввода пароля

## Использование

### Подключение к серверу

```bash
ssh root@43.245.224.114
```

Пароль больше не требуется!

### Копирование файлов

```bash
# Загрузить файл на сервер
scp local-file.txt root@43.245.224.114:/path/to/destination/

# Скачать файл с сервера
scp root@43.245.224.114:/path/to/file.txt ./local-directory/
```

### Выполнение команд

```bash
# Выполнить одну команду
ssh root@43.245.224.114 "docker ps"

# Выполнить несколько команд
ssh root@43.245.224.114 "cd /opt/elia-platform && docker compose logs --tail=50"
```

## Обновление приложения на сервере

Теперь можно без expect-скриптов:

```bash
# Обновить контейнер
ssh root@43.245.224.114 "cd /opt/elia-platform && docker compose pull && docker compose up -d"

# Проверить логи
ssh root@43.245.224.114 "docker logs elia-platform --tail=100"

# Перезапустить контейнер
ssh root@43.245.224.114 "cd /opt/elia-platform && docker compose restart"
```

## Безопасность

### Защита приватного ключа

Ваш приватный ключ должен быть доступен только вам:

```bash
chmod 600 ~/.ssh/id_ed25519
chmod 644 ~/.ssh/id_ed25519.pub
```

### Рекомендации

1. **Не передавайте приватный ключ** (`id_ed25519`) никому
2. **Делайте резервные копии** приватного ключа в безопасном месте
3. **Используйте парольную защиту** для приватного ключа в production-среде

### Добавление пароля к существующему ключу

Если захотите добавить пароль позже:

```bash
ssh-keygen -p -f ~/.ssh/id_ed25519
```

## Отзыв доступа

Если нужно отозвать доступ с этого компьютера:

```bash
# На сервере выполните:
ssh root@43.245.224.114
nano ~/.ssh/authorized_keys
# Удалите строку с вашим публичным ключом
```

## Дополнительные настройки

### SSH конфигурация для удобства

Создайте файл `~/.ssh/config`:

```
Host elia-server
    HostName 43.245.224.114
    User root
    IdentityFile ~/.ssh/id_ed25519
    ServerAliveInterval 60
    ServerAliveCountMax 3
```

После этого можно подключаться просто:

```bash
ssh elia-server
```

## Устранение неполадок

### Подключение запрашивает пароль

Проверьте:

```bash
# Права на приватный ключ
ls -la ~/.ssh/id_ed25519

# Должно быть: -rw------- (600)
chmod 600 ~/.ssh/id_ed25519

# Проверка подключения с отладкой
ssh -v root@43.245.224.114
```

### Ключ не работает

Проверьте на сервере:

```bash
ssh root@43.245.224.114
cat ~/.ssh/authorized_keys
# Должна быть строка начинающаяся с "ssh-ed25519 ..."
```

## История изменений

- **2025-10-26**: Настроен SSH доступ по ключам для сервера 43.245.224.114

