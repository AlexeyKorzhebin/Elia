"""
Набор тестовых данных для проверки работоспособности приложения
Используется для тестирования API, функциональности без изменения БД новыми приёмами
"""

# ============================================================================
# ТЕСТОВЫЕ ТРАНСКРИПЦИИ РАЗГОВОРОВ
# ============================================================================

TRANSCRIPTION_CARDIOVASCULAR = """
Врач: Здравствуйте! Проходите, присаживайтесь. Что вас беспокоит?

Пациент: Добрый день, доктор. Последние две недели у меня периодически возникают боли в области сердца, особенно при физической нагрузке. Также заметил одышку при подъёме по лестнице.

Врач: Понятно. А как бы вы описали характер боли? Давящая, колющая, жгучая?

Пациент: Скорее давящая, как будто что-то сжимает в груди. Иногда отдаёт в левую руку.

Врач: Сколько длится приступ боли?

Пациент: Обычно минут 5-10, потом проходит. Но вчера было дольше, минут 15.

Врач: А давление измеряли? Какие цифры?

Пациент: Да, измерял дома. Обычно 140 на 90, но вчера было 160 на 100.

Врач: Есть ли у вас хронические заболевания? Гипертония, сахарный диабет?

Пациент: Гипертония есть, принимаю Эналаприл уже три года. Диабета нет.

Врач: Курение, алкоголь?

Пациент: Курю лет 15, пачку в день. Алкоголь редко, по праздникам.

Врач: Сейчас я вас осмотрю. При аускультации сердца тоны приглушены, ритм правильный. Шумов не выслушивается. Давление 155 на 95, пульс 88 ударов в минуту.

Пациент: Это серьёзно, доктор?

Врач: Симптомы могут указывать на ишемическую болезнь сердца. Назначу вам ЭКГ, ЭхоКГ, анализ крови на холестерин и липидный спектр. Также рекомендую холтеровское мониторирование для оценки работы сердца в течение суток.

Пациент: Хорошо, доктор. А что с лечением?

Врач: Пока продолжим приём Эналаприла, но возможно потребуется коррекция дозы или добавление других препаратов. Обязательно нужно бросить курить — это критически важно. Также ограничить соль в рационе.

Пациент: Понял, спасибо большое!
"""

TRANSCRIPTION_RESPIRATORY = """
Врач: Здравствуйте! Расскажите, что вас беспокоит?

Пациент: Добрый день. Уже неделю кашель, сначала был сухой, теперь с мокротой. Температура была 37.5, сейчас нормальная. Но кашель не проходит.

Врач: Какого цвета мокрота? Есть ли одышка?

Пациент: Мокрота желтоватая, густая. Одышки нет, но при глубоком вдохе немного покалывает в груди.

Врач: Боль в горле, насморк были?

Пациент: Да, в начале была боль в горле и насморк, но это прошло. Остался только кашель.

Врач: Курите? Как долго?

Пациент: Да, курю лет 10, но не много, 5-7 сигарет в день.

Врач: Принимали что-то от кашля?

Пациент: Пил сироп от кашля, немного помогает, но не полностью.

Врач: Сейчас послушаю лёгкие. При аускультации выслушиваются влажные хрипы в нижних отделах справа. Температура 36.8, давление в норме.

Пациент: Что это может быть?

Врач: Судя по симптомам, у вас бронхит. Назначу рентген грудной клетки для исключения пневмонии, общий анализ крови. По поводу лечения: антибиотик Амоксиклав, отхаркивающие средства, ингаляции. И очень важно — нужно бросить курить хотя бы на время лечения.

Пациент: Хорошо, доктор. Спасибо!
"""

TRANSCRIPTION_GASTROENTEROLOGY = """
Врач: Здравствуйте! Проходите, садитесь. Что вас привело?

Пациент: Здравствуйте, доктор. Месяц назад начались проблемы с желудком. После еды появляется тяжесть, иногда тошнота. Особенно после жирной или острой пищи.

Врач: Аппетит как? Была ли рвота?

Пациент: Аппетит нормальный, но стараюсь есть меньше, чтобы не было дискомфорта. Рвоты не было.

Врач: Стул нормальный? Цвет, консистенция?

Пациент: Стул нерегулярный, иногда запоры. Цвет обычный.

Врач: Принимаете какие-то препараты постоянно? Обезболивающие, например?

Пациент: Да, иногда принимаю Ибупрофен от головной боли. Но не часто.

Врач: Есть ли хронические заболевания желудочно-кишечного тракта?

Пациент: Нет, раньше проблем не было.

Врач: При осмотре: живот мягкий, при пальпации умеренная болезненность в эпигастральной области. Печень и селезёнка не увеличены.

Пациент: Что это может быть?

Врач: Симптомы могут указывать на гастрит или функциональную диспепсию. Назначу гастроскопию для уточнения диагноза, анализ на Helicobacter pylori. По поводу лечения: диета — исключить острое, жирное, жареное, кофе, алкоголь. Питаться часто, небольшими порциями. Назначу Омепразол и препараты для улучшения моторики желудка.

Пациент: А гастроскопия — это больно?

Врач: Неприятно, но терпимо. Можно сделать под седацией, если боитесь. Запишитесь на процедуру, и после получения результатов приходите на повторный приём.

Пациент: Хорошо, спасибо, доктор!
"""

TRANSCRIPTION_NEUROLOGY = """
Врач: Добрый день! Расскажите, что беспокоит?

Пациент: Добрый день. У меня часто болит голова, особенно в области висков и затылка. Началось месяца два назад, сначала редко, теперь почти каждый день.

Врач: Какой характер боли? Пульсирующая, давящая?

Пациент: Давящая, как будто обруч на голове. Иногда тошнит от боли.

Врач: Что провоцирует боль? Стресс, недосып, определённая еда?

Пациент: Да, особенно после недосыпа или когда сильно устаю на работе. Кофе помогает немного.

Врач: Зрение в норме? Не было ли головокружений?

Пациент: Зрение нормальное. Головокружений не было.

Врач: Измеряли давление?

Пациент: Да, обычно 130 на 85, иногда выше.

Врач: При неврологическом осмотре: сознание ясное, речь не нарушена. Рефлексы симметричные, в норме. Менингеальных знаков нет. Давление 135 на 88.

Пациент: Это мигрень?

Врач: Скорее всего, это головная боль напряжения, возможно, в сочетании с артериальной гипертензией. Назначу МРТ головного мозга для исключения органических причин, консультацию офтальмолога с осмотром глазного дна. По поводу лечения: при приступах — Ибупрофен или Парацетамол. Но важно нормализовать режим сна, снизить стресс, возможно, нужна консультация психолога.

Пациент: А МРТ обязательно?

Врач: Да, для вашего возраста и при таких частых головных болях это необходимо для исключения серьёзных причин. После получения результатов приходите на повторный приём.

Пациент: Хорошо, спасибо!
"""

TRANSCRIPTION_SHORT = """
Врач: Здравствуйте! Что вас беспокоит?

Пациент: Добрый день. Болит горло уже три дня, больно глотать.

Врач: Температура есть?

Пациент: Да, 38.2.

Врач: При осмотре: горло красное, миндалины увеличены, налёта нет. Это фарингит. Назначу полоскания, спрей для горла, жаропонижающее при температуре выше 38.5.

Пациент: Спасибо, доктор!
"""

# ============================================================================
# ТЕСТОВЫЕ ДАННЫЕ ДЛЯ АНАМНЕЗА
# ============================================================================

ANAMNESIS_DATA_CARDIOVASCULAR = {
    "purpose": "Консультация терапевта по поводу болей в области сердца и одышки",
    "complaints": "Периодические давящие боли в области сердца при физической нагрузке, одышка при подъёме по лестнице. Приступы боли длятся 5-15 минут, иногда иррадиируют в левую руку. Артериальное давление повышено до 160/100 мм рт.ст.",
    "anamnesis": "Симптомы появились две недели назад. Пациент страдает гипертонией в течение трёх лет, принимает Эналаприл. Курит 15 лет, пачку в день. Наследственность отягощена по сердечно-сосудистым заболеваниям. При осмотре: АД 155/95, пульс 88 уд/мин. Тоны сердца приглушены. Назначено обследование: ЭКГ, ЭхоКГ, липидный спектр, холтер."
}

ANAMNESIS_DATA_RESPIRATORY = {
    "purpose": "Консультация по поводу кашля с мокротой",
    "complaints": "Кашель с желтоватой мокротой в течение недели. Ранее была температура 37.5°C, боль в горле, насморк. При глубоком вдохе покалывание в груди. Кашель сохраняется несмотря на приём сиропа от кашля.",
    "anamnesis": "Заболевание началось неделю назад с симптомов ОРВИ. Пациент курит 10 лет, 5-7 сигарет в день. При осмотре: температура 36.8°C, АД в норме. При аускультации выслушиваются влажные хрипы в нижних отделах справа. Диагноз: бронхит. Назначено: рентген грудной клетки, ОАК, антибиотикотерапия, отхаркивающие средства, ингаляции."
}

ANAMNESIS_DATA_GASTROENTEROLOGY = {
    "purpose": "Консультация по поводу диспепсических явлений",
    "complaints": "Тяжесть в желудке после еды, особенно после жирной и острой пищи. Периодическая тошнота. Нерегулярный стул со склонностью к запорам. Симптомы беспокоят в течение месяца.",
    "anamnesis": "Симптомы появились месяц назад. Пациент периодически принимает Ибупрофен от головной боли. Хронических заболеваний ЖКТ ранее не было. При осмотре: живот мягкий, умеренная болезненность в эпигастральной области при пальпации. Печень и селезёнка не увеличены. Подозрение на гастрит или функциональную диспепсию. Назначено: гастроскопия, анализ на H.pylori, диета, Омепразол, прокинетики."
}

ANAMNESIS_DATA_NEUROLOGY = {
    "purpose": "Консультация по поводу частых головных болей",
    "complaints": "Ежедневные давящие головные боли в области висков и затылка в течение двух месяцев. Боль провоцируется недосыпом, усталостью, стрессом. Иногда сопровождается тошнотой. Артериальное давление 130-135/85-88 мм рт.ст.",
    "anamnesis": "Головные боли начались два месяца назад, постепенно участились. Пациент связывает их с работой и недосыпом. Кофе немного облегчает состояние. При неврологическом осмотре патологии не выявлено. АД 135/88. Предварительный диагноз: головная боль напряжения, возможно в сочетании с артериальной гипертензией. Назначено: МРТ головного мозга, консультация офтальмолога, симптоматическое лечение, нормализация режима."
}

# ============================================================================
# ТЕСТОВЫЕ ЗАПРОСЫ ДЛЯ API
# ============================================================================

# Тестовые данные для создания/обновления медицинского отчёта
TEST_MEDICAL_REPORT_1 = {
    "purpose": "Плановый осмотр",
    "complaints": "Жалоб нет",
    "anamnesis": "Пациент чувствует себя хорошо, хронических заболеваний не отмечает."
}

TEST_MEDICAL_REPORT_2 = {
    "purpose": "Консультация по поводу повышенного артериального давления",
    "complaints": "Головные боли, особенно в утренние часы. Периодическое головокружение.",
    "anamnesis": "Повышенное давление отмечает в течение года. Принимал препараты нерегулярно. Наследственность отягощена по гипертонии."
}

TEST_MEDICAL_REPORT_3 = {
    "purpose": "Острая боль в животе",
    "complaints": "Острая боль в правой подвздошной области, усиливающаяся при движении. Тошнота, однократная рвота.",
    "anamnesis": "Боль появилась 6 часов назад, постепенно усиливается. Температура 37.8°C. Подозрение на острый аппендицит."
}

# Тестовые данные для обновления транскрипции
TEST_TRANSCRIPTION_UPDATE_1 = {
    "transcription_text": """
Врач: Здравствуйте! Что вас беспокоит?
Пациент: Добрый день. Болит спина уже неделю.
Врач: Где именно болит?
Пациент: В поясничной области, особенно при наклонах.
Врач: Принимали обезболивающие?
Пациент: Да, немного помогает.
Врач: Назначу МРТ поясничного отдела позвоночника и противовоспалительные препараты.
"""
}

TEST_TRANSCRIPTION_UPDATE_2 = {
    "transcription_text": """
Врач: Здравствуйте! Расскажите о вашей проблеме.
Пациент: У меня проблемы со сном. Не могу заснуть, просыпаюсь ночью.
Врач: Как давно это началось?
Пациент: Около месяца. Связано со стрессом на работе.
Врач: Принимаете что-то для сна?
Пациент: Иногда валерьянку, но не помогает.
Врач: Рекомендую консультацию невролога и нормализацию режима дня.
"""
}

# Тестовые данные для обновления давления
TEST_BLOOD_PRESSURE_1 = {
    "systolic": 140,
    "diastolic": 90,
    "pulse": 75,
    "source": "manual"
}

TEST_BLOOD_PRESSURE_2 = {
    "systolic": 120,
    "diastolic": 80,
    "pulse": 70,
    "source": "tonometer_recognition"
}

TEST_BLOOD_PRESSURE_3 = {
    "systolic": 160,
    "diastolic": 100,
    "pulse": 88,
    "source": "manual"
}

# ============================================================================
# ТЕСТОВЫЕ СЦЕНАРИИ ИСПОЛЬЗОВАНИЯ
# ============================================================================

TEST_SCENARIOS = {
    "scenario_1_full_workflow": {
        "description": "Полный workflow: генерация транскрипции → редактирование → извлечение анамнеза → сохранение отчёта",
        "steps": [
            "1. Сгенерировать транскрипцию разговора через /api/audio/generate-mock-conversation",
            "2. Получить транскрипцию через /api/audio/{audio_id}",
            "3. Обновить транскрипцию через /api/audio/{audio_id}/transcription",
            "4. Извлечь анамнез через /api/audio/{audio_id}/extract-anamnesis",
            "5. Получить отчёт через /api/appointments/{appointment_id}/report",
            "6. Отправить в МИС через /api/appointments/{appointment_id}/submit-to-mis"
        ]
    },
    
    "scenario_2_transcription_editing": {
        "description": "Редактирование транскрипции с сохранением изменений",
        "steps": [
            "1. Получить существующую транскрипцию",
            "2. Внести изменения в текст",
            "3. Сохранить через PUT /api/audio/{audio_id}/transcription",
            "4. Проверить сохранение через GET /api/audio/{audio_id}",
            "5. Переключиться на другую вкладку и вернуться",
            "6. Убедиться, что изменения сохранились"
        ]
    },
    
    "scenario_3_anamnesis_extraction": {
        "description": "Извлечение анамнеза из транскрипции",
        "steps": [
            "1. Убедиться, что есть транскрипция",
            "2. Вызвать POST /api/audio/{audio_id}/extract-anamnesis",
            "3. Проверить заполнение полей purpose, complaints, anamnesis",
            "4. Сохранить отчёт через POST /api/appointments/{appointment_id}/report"
        ]
    },
    
    "scenario_4_blood_pressure": {
        "description": "Работа с показателями артериального давления",
        "steps": [
            "1. Загрузить фото тонометра через POST /api/patients/{patient_id}/recognize-tonometer",
            "2. Сохранить показатели через POST /api/patients/{patient_id}/blood-pressure",
            "3. Проверить обновление через GET /api/patients/{patient_id}/digital-portrait"
        ]
    },
    
    "scenario_5_pdf_generation": {
        "description": "Генерация PDF отчёта о приёме",
        "steps": [
            "1. Убедиться, что есть медицинский отчёт",
            "2. Вызвать GET /api/appointments/{appointment_id}/download-pdf",
            "3. Проверить корректность содержимого PDF",
            "4. Проверить наличие всех данных: пациент, приём, отчёт"
        ]
    },
    
    "scenario_6_search_patients": {
        "description": "Поиск пациентов по имени",
        "steps": [
            "1. Вызвать GET /api/patients?search=Иванов",
            "2. Проверить результаты поиска",
            "3. Вызвать GET /api/appointments?search=Иванов",
            "4. Проверить результаты поиска в приёмах"
        ]
    }
}

# ============================================================================
# ТЕСТОВЫЕ ТЕКСТЫ ДЛЯ ВАЛИДАЦИИ
# ============================================================================

# Тексты для проверки обработки граничных случаев
EDGE_CASE_TEXTS = {
    "empty_transcription": "",
    "very_long_transcription": "Врач: " + "Что вас беспокоит? " * 1000 + "\nПациент: " + "Болит голова. " * 1000,
    "special_characters": "Врач: Здравствуйте! Что вас беспокоит?\nПациент: Болит голова & желудок! @#$%^&*()",
    "unicode_text": "Врач: Здравствуйте! Что вас беспокоит?\nПациент: Болит голова. Принимал таблетки: ½ таблетки 2 раза в день.",
    "multiline_text": "Врач: Здравствуйте!\n\nЧто вас беспокоит?\n\nПациент: Добрый день.\n\nБолит голова.\n\nВрач: Понятно.\n\nНазначу лечение.",
    "with_numbers": "Врач: Какое давление?\nПациент: 140 на 90. Пульс 75. Температура 36.6.",
    "with_dates": "Врач: Когда началось?\nПациент: 15.10.2025 года, около 10:30 утра."
}

# ============================================================================
# ТЕСТОВЫЕ ДАННЫЕ ДЛЯ ПРОВЕРКИ ОШИБОК
# ============================================================================

ERROR_TEST_CASES = {
    "invalid_appointment_id": {
        "description": "Попытка работы с несуществующим приёмом",
        "appointment_id": 99999
    },
    "invalid_audio_id": {
        "description": "Попытка работы с несуществующим аудиофайлом",
        "audio_id": 99999
    },
    "invalid_patient_id": {
        "description": "Попытка работы с несуществующим пациентом",
        "patient_id": 99999
    },
    "invalid_blood_pressure": {
        "description": "Некорректные значения давления",
        "systolic": 500,  # Превышает допустимый диапазон
        "diastolic": 10,  # Ниже допустимого диапазона
        "pulse": 300  # Превышает допустимый диапазон
    },
    "empty_medical_report": {
        "description": "Создание отчёта с пустыми полями",
        "purpose": "",
        "complaints": "",
        "anamnesis": ""
    }
}

# ============================================================================
# ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ ДЛЯ ТЕСТИРОВАНИЯ
# ============================================================================

def get_test_transcription(scenario: str = "cardiovascular") -> str:
    """Получить тестовую транскрипцию по сценарию"""
    transcriptions = {
        "cardiovascular": TRANSCRIPTION_CARDIOVASCULAR,
        "respiratory": TRANSCRIPTION_RESPIRATORY,
        "gastroenterology": TRANSCRIPTION_GASTROENTEROLOGY,
        "neurology": TRANSCRIPTION_NEUROLOGY,
        "short": TRANSCRIPTION_SHORT
    }
    return transcriptions.get(scenario, TRANSCRIPTION_SHORT)


def get_test_anamnesis(scenario: str = "cardiovascular") -> dict:
    """Получить тестовые данные анамнеза по сценарию"""
    anamnesis_data = {
        "cardiovascular": ANAMNESIS_DATA_CARDIOVASCULAR,
        "respiratory": ANAMNESIS_DATA_RESPIRATORY,
        "gastroenterology": ANAMNESIS_DATA_GASTROENTEROLOGY,
        "neurology": ANAMNESIS_DATA_NEUROLOGY
    }
    return anamnesis_data.get(scenario, ANAMNESIS_DATA_CARDIOVASCULAR)


def get_test_medical_report(variant: int = 1) -> dict:
    """Получить тестовые данные для медицинского отчёта"""
    reports = {
        1: TEST_MEDICAL_REPORT_1,
        2: TEST_MEDICAL_REPORT_2,
        3: TEST_MEDICAL_REPORT_3
    }
    return reports.get(variant, TEST_MEDICAL_REPORT_1)


def get_test_blood_pressure(variant: int = 1) -> dict:
    """Получить тестовые данные для артериального давления"""
    pressures = {
        1: TEST_BLOOD_PRESSURE_1,
        2: TEST_BLOOD_PRESSURE_2,
        3: TEST_BLOOD_PRESSURE_3
    }
    return pressures.get(variant, TEST_BLOOD_PRESSURE_1)

