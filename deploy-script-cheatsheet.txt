╔══════════════════════════════════════════════════════════════╗
║        ОБНОВЛЕННЫЙ СКРИПТ deploy-ubuntu.sh                   ║
║        для репозитория https://github.com/AlexeyKorzhebin/Elia ║
╚══════════════════════════════════════════════════════════════╝

🎯 ОСНОВНАЯ КОМАНДА ДЛЯ ELIA.SU
────────────────────────────────────────────────────────────────
./deploy-ubuntu.sh -d elia.su -k ваш-openai-ключ -e admin@elia.su

📋 ПАРАМЕТРЫ
────────────────────────────────────────────────────────────────
-d, --domain elia.su        Домен приложения (обязательно)
-k, --openai-key KEY       OpenAI API ключ (обязательно)
-e, --email admin@elia.su  Email для SSL сертификата
--no-nginx                 Не устанавливать Nginx
--no-ssl                   Не настраивать SSL
-h, --help                 Показать справку

📝 ПРИМЕРЫ ИСПОЛЬЗОВАНИЯ
────────────────────────────────────────────────────────────────
# Полная установка с SSL
./deploy-ubuntu.sh -d elia.su -k sk-proj-abc123... -e admin@elia.su

# Установка без SSL (для тестирования)
./deploy-ubuntu.sh -d elia.su -k sk-proj-abc123... --no-ssl

# Установка без Nginx
./deploy-ubuntu.sh -d elia.su -k sk-proj-abc123... -e admin@elia.su --no-nginx

# Минимальная установка
./deploy-ubuntu.sh -d elia.su -k sk-proj-abc123... --no-nginx --no-ssl

🔧 ЧТО ИЗМЕНИЛОСЬ В СКРИПТЕ
────────────────────────────────────────────────────────────────
✅ Репозиторий: https://github.com/AlexeyKorzhebin/Elia
✅ Домен по умолчанию: elia.su
✅ Умное использование .env.example
✅ Проверка существующих файлов
✅ Не создает заглушки если файлы есть

🌐 НАСТРОЙКА ДОМЕНА ELIA.SU
────────────────────────────────────────────────────────────────
1. В DNS настройках добавьте A-запись:
   Тип: A
   Имя: @
   Значение: IP_ВАШЕГО_СЕРВЕРА

2. Проверьте:
   nslookup elia.su

🔑 ПОЛУЧЕНИЕ OPENAI API КЛЮЧА
────────────────────────────────────────────────────────────────
1. https://platform.openai.com/
2. API Keys: https://platform.openai.com/api-keys
3. Создайте ключ (начинается с sk-)
4. Пополните баланс (минимум $5)

🚀 БЫСТРЫЙ СТАРТ НА СЕРВЕРЕ
────────────────────────────────────────────────────────────────
# Подготовка
sudo apt update && sudo apt upgrade -y
sudo apt install -y curl wget git unzip

# Скачивание скрипта
wget https://raw.githubusercontent.com/AlexeyKorzhebin/Elia/main/scripts/deploy-ubuntu.sh
chmod +x deploy-ubuntu.sh

# Запуск установки
./deploy-ubuntu.sh -d elia.su -k ваш-openai-ключ -e admin@elia.su

✅ ЧТО ПОЛУЧИТСЯ ПОСЛЕ УСТАНОВКИ
────────────────────────────────────────────────────────────────
/opt/elia-platform/          # Проект из GitHub
├── .env                     # Конфигурация (из .env.example)
├── app/                     # Код приложения
├── static/                  # Статические файлы
├── templates/               # HTML шаблоны
├── data/elia.db             # База данных
├── logs/                    # Логи
└── static/uploads/          # Загрузки

Сервисы:
✅ Docker + Elia Platform
✅ Nginx reverse proxy
✅ SSL сертификат
✅ Systemd автозапуск
✅ UFW файрвол

🔧 УПРАВЛЕНИЕ ПОСЛЕ УСТАНОВКИ
────────────────────────────────────────────────────────────────
sudo systemctl status elia-platform    # Статус
sudo systemctl restart elia-platform   # Перезапуск
sudo journalctl -u elia-platform -f   # Логи
docker compose logs -f                 # Логи Docker

# Обновление
cd /opt/elia-platform
git pull
docker compose build
sudo systemctl restart elia-platform

✅ ПРОВЕРКА РАБОТЫ
────────────────────────────────────────────────────────────────
curl https://elia.su/health            # Health check
curl -I https://elia.su               # Доступность сайта
open https://elia.su                   # Открыть в браузере

🐛 УСТРАНЕНИЕ НЕПОЛАДОК
────────────────────────────────────────────────────────────────
# Репозиторий не клонируется
ping github.com
ls -la /opt/elia-platform

# .env не создается
ls -la /opt/elia-platform/.env*
cp .env.example .env

# SSL не работает
nslookup elia.su
sudo certbot certificates

📚 ДОКУМЕНТАЦИЯ
────────────────────────────────────────────────────────────────
DEPLOY_SCRIPT_UPDATED.md           # Обновленная инструкция
DEPLOY_PARAMETERS.md               # Подробные параметры
deploy-parameters-cheatsheet.txt   # Шпаргалка команд
UBUNTU_DEPLOYMENT.md               # Полное руководство

🎯 ИТОГОВАЯ КОМАНДА
────────────────────────────────────────────────────────────────
./deploy-ubuntu.sh -d elia.su -k ваш-openai-ключ -e admin@elia.su

Замените:
- ваш-openai-ключ → ключ от OpenAI (sk-...)
- admin@elia.su → ваш email

Пример:
./deploy-ubuntu.sh -d elia.su -k sk-proj-abc123def456ghi789jkl012mno345pqr678stu901vwx234yz567890 -e admin@elia.su

⚠️ ВАЖНЫЕ МОМЕНТЫ
────────────────────────────────────────────────────────────────
✅ Скрипт использует реальный репозиторий с GitHub
✅ Автоматически использует существующий .env.example
✅ Не создает заглушки если файлы уже есть
✅ Настроен для домена elia.su
✅ Все параметры можно изменить через .env после установки

═══════════════════════════════════════════════════════════════
